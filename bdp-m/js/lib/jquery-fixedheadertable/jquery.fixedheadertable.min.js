!function(a){a.fn.fixedHeaderTable=function(b){var c={width:"100%",height:"100%",themeClass:"fht-default",borderCollapse:!0,fixedColumns:0,fixedColumn:!1,sortable:!1,autoShow:!0,footer:!1,cloneHeadToFoot:!1,autoResize:!1,create:null},d={},e={init:function(b){return d=a.extend({},c,b),this.each(function(){var b=a(this);f._isTable(b)?(e.setup.apply(this,Array.prototype.slice.call(arguments,1)),a.isFunction(d.create)&&d.create.call(this)):a.error("Invalid table mark-up")})},setup:function(){var j,k,l,m,n,b=a(this),c=this,g=b.find("thead"),h=b.find("tfoot"),i=0;d.originalTable=a(this).clone(),d.includePadding=f._isPaddingIncludedWithWidth(),d.scrollbarOffset=f._getScrollbarWidth(),d.themeClassName=d.themeClass,n=d.width.search("%")>-1?b.parent().width()-d.scrollbarOffset:d.width-d.scrollbarOffset,b.css({width:n}),b.closest(".fht-table-wrapper").length||(b.addClass("fht-table"),b.wrap('<div class="fht-table-wrapper"></div>')),j=b.closest(".fht-table-wrapper"),1==d.fixedColumn&&d.fixedColumns<=0&&(d.fixedColumns=1),d.fixedColumns>0&&0==j.find(".fht-fixed-column").length&&(b.wrap('<div class="fht-fixed-body"></div>'),a('<div class="fht-fixed-column"></div>').prependTo(j),m=j.find(".fht-fixed-body")),j.css({width:d.width,height:d.height}).addClass(d.themeClassName),b.hasClass("fht-table-init")||b.wrap('<div class="fht-tbody"></div>'),l=b.closest(".fht-tbody");var o=f._getTableProps(b);f._setupClone(l,o.tbody),b.hasClass("fht-table-init")?k=j.find("div.fht-thead"):(k=d.fixedColumns>0?a('<div class="fht-thead"><table class="fht-table"></table></div>').prependTo(m):a('<div class="fht-thead"><table class="fht-table"></table></div>').prependTo(j),k.find("table.fht-table").addClass(d.originalTable.attr("class")).attr("style",d.originalTable.attr("style")),g.clone().appendTo(k.find("table"))),f._setupClone(k,o.thead),b.css({"margin-top":-k.outerHeight(!0)}),1==d.footer&&(f._setupTableFooter(b,c,o),h.length||(h=j.find("div.fht-tfoot table")),i=h.outerHeight(!0));var p=j.height()-g.outerHeight(!0)-i-o.border;return l.css({height:p}),b.addClass("fht-table-init"),"undefined"!=typeof d.altClass&&e.altRows.apply(c),d.fixedColumns>0&&f._setupFixedColumn(b,c,o),d.autoShow||j.hide(),f._bindScroll(l,o),c},resize:function(){var a=this;return a},altRows:function(b){var c=a(this),e="undefined"!=typeof b?b:d.altClass;c.closest(".fht-table-wrapper").find("tbody tr:odd:not(:hidden)").addClass(e)},show:function(b,c,d){var e=a(this),f=this,g=e.closest(".fht-table-wrapper");return"undefined"!=typeof b&&"number"==typeof b?(g.show(b,function(){a.isFunction(c)&&c.call(this)}),f):"undefined"!=typeof b&&"string"==typeof b&&"undefined"!=typeof c&&"number"==typeof c?(g.show(b,c,function(){a.isFunction(d)&&d.call(this)}),f):(e.closest(".fht-table-wrapper").show(),a.isFunction(b)&&b.call(this),f)},hide:function(b,c,d){var e=a(this),f=this,g=e.closest(".fht-table-wrapper");return"undefined"!=typeof b&&"number"==typeof b?(g.hide(b,function(){a.isFunction(d)&&d.call(this)}),f):"undefined"!=typeof b&&"string"==typeof b&&"undefined"!=typeof c&&"number"==typeof c?(g.hide(b,c,function(){a.isFunction(d)&&d.call(this)}),f):(e.closest(".fht-table-wrapper").hide(),a.isFunction(d)&&d.call(this),f)},destroy:function(){var b=a(this),c=this,d=b.closest(".fht-table-wrapper");return b.insertBefore(d).removeAttr("style").append(d.find("tfoot")).removeClass("fht-table fht-table-init").find(".fht-cell").remove(),d.remove(),c}},f={_isTable:function(a){var b=a,c=b.is("table"),d=b.find("thead").length>0,e=b.find("tbody").length>0;return c&&d&&e?!0:!1},_bindScroll:function(a){var b=a,c=b.closest(".fht-table-wrapper"),e=b.siblings(".fht-thead"),f=b.siblings(".fht-tfoot");b.bind("scroll",function(){if(d.fixedColumns>0){var a=c.find(".fht-fixed-column");a.find(".fht-tbody table").css({"margin-top":-b.scrollTop()})}e.find("table").css({"margin-left":-this.scrollLeft}),(d.footer||d.cloneHeadToFoot)&&f.find("table").css({"margin-left":-this.scrollLeft})})},_fixHeightWithCss:function(a,b){d.includePadding?a.css({height:a.height()+b.border}):a.css({height:a.parent().height()+b.border})},_fixWidthWithCss:function(b,c,e){d.includePadding=!0,d.includePadding?b.each(function(){a(this).css({width:void 0==e?a(this).width()+c.border:e+c.border})}):b.each(function(){a(this).css({width:void 0==e?a(this).parent().width()+c.border:e+c.border})})},_setupFixedColumn:function(b,c,e){var p,q,r,s,t,g=b,h=g.closest(".fht-table-wrapper"),i=h.find(".fht-fixed-body"),j=h.find(".fht-fixed-column"),k=a('<div class="fht-thead"><table class="fht-table"><thead><tr></tr></thead></table></div>'),l=a('<div class="fht-tbody"><table class="fht-table"><tbody></tbody></table></div>'),m=a('<div class="fht-tfoot"><table class="fht-table"><tfoot><tr></tr></tfoot></table></div>'),n=h.width(),o=i.find(".fht-tbody").height()-d.scrollbarOffset;k.find("table.fht-table").addClass(d.originalTable.attr("class")),l.find("table.fht-table").addClass(d.originalTable.attr("class")),m.find("table.fht-table").addClass(d.originalTable.attr("class")),p=i.find(".fht-thead thead tr > *:lt("+d.fixedColumns+")"),r=d.fixedColumns*e.border,p.each(function(){r+=a(this).outerWidth(!0)}),f._fixHeightWithCss(p,e),f._fixWidthWithCss(p,e);var u=[];p.each(function(){u.push(a(this).width())}),t="tbody tr > *:not(:nth-child(n+"+(d.fixedColumns+1)+"))",q=i.find(t).each(function(b){f._fixHeightWithCss(a(this),e),f._fixWidthWithCss(a(this),e,u[b%d.fixedColumns])}),k.appendTo(j).find("tr").append(p.clone()),l.appendTo(j).css({"margin-top":-1,height:o+e.border}),q.each(function(b){0==b%d.fixedColumns&&(s=a("<tr></tr>").appendTo(l.find("tbody")),d.altClass&&a(this).parent().hasClass(d.altClass)&&s.addClass(d.altClass)),a(this).clone().appendTo(s)}),j.css({height:0,width:r});var v=j.find(".fht-tbody .fht-table").height()-j.find(".fht-tbody").height();if(j.find(".fht-tbody .fht-table").bind("mousewheel",function(b,c,d,e){if(0!=e){var f=parseInt(a(this).css("marginTop"),10)+(e>0?120:-120);return f>0&&(f=0),-v>f&&(f=-v),a(this).css("marginTop",f),i.find(".fht-tbody").scrollTop(-f).scroll(),!1}}),i.css({width:n}),1==d.footer||1==d.cloneHeadToFoot){var x,w=i.find(".fht-tfoot tr > *:lt("+d.fixedColumns+")");f._fixHeightWithCss(w,e),m.appendTo(j).find("tr").append(w.clone()),x=m.find("table").innerWidth(),m.css({top:d.scrollbarOffset,width:x})}},_setupTableFooter:function(b,c,e){var g=b,h=g.closest(".fht-table-wrapper"),i=g.find("tfoot"),j=h.find("div.fht-tfoot");switch(j.length||(j=d.fixedColumns>0?a('<div class="fht-tfoot"><table class="fht-table"></table></div>').appendTo(h.find(".fht-fixed-body")):a('<div class="fht-tfoot"><table class="fht-table"></table></div>').appendTo(h)),j.find("table.fht-table").addClass(d.originalTable.attr("class")),!0){case!i.length&&1==d.cloneHeadToFoot&&1==d.footer:var k=h.find("div.fht-thead");j.empty(),k.find("table").clone().appendTo(j);break;case i.length&&0==d.cloneHeadToFoot&&1==d.footer:j.find("table").append(i).css({"margin-top":-e.border}),f._setupClone(j,e.tfoot)}},_getTableProps:function(b){var c={thead:{},tbody:{},tfoot:{},border:0},e=1;return 1==d.borderCollapse&&(e=2),c.border=1,b.find("thead tr:first-child > *").each(function(b){c.thead[b]=a(this).width()+c.border}),b.find("tfoot tr:first-child > *").each(function(b){c.tfoot[b]=a(this).width()+c.border}),b.find("tbody tr:first-child > *").each(function(b){c.tbody[b]=a(this).width()+c.border}),c},_setupClone:function(b,c){var f,d=b,e=d.find("thead").length?"thead tr:first-child > *":d.find("tfoot").length?"tfoot tr:first-child > *":"tbody tr:first-child > *";d.find(e).each(function(b){f=a(this).find("div.fht-cell").length?a(this).find("div.fht-cell"):a('<div class="fht-cell"></div>').appendTo(a(this)),f.css({width:parseInt(c[b],10)})})},_isPaddingIncludedWithWidth:function(){var c,e,b=a('<table class="fht-table"><tr><td style="padding: 10px; font-size: 10px;">test</td></tr></table>');return b.addClass(d.originalTable.attr("class")),b.appendTo("body"),c=b.find("td").height(),b.find("td").css("height",b.find("tr").height()),e=b.find("td").height(),b.remove(),c!=e?!0:!1},_getScrollbarWidth:function(){var b=0;if(!b)if(/msie/.test(navigator.userAgent.toLowerCase())){var c=a('<textarea cols="10" rows="2"></textarea>').css({position:"absolute",top:-1e3,left:-1e3}).appendTo("body"),d=a('<textarea cols="10" rows="2" style="overflow: hidden;"></textarea>').css({position:"absolute",top:-1e3,left:-1e3}).appendTo("body");b=c.width()-d.width()+2,c.add(d).remove()}else{var e=a("<div />").css({width:100,height:100,overflow:"auto",position:"absolute",top:-1e3,left:-1e3}).prependTo("body").append("<div />").find("div").css({width:"100%",height:200});b=100-e.width(),e.parent().remove()}return b}};return e[b]?e[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?(a.error('Method "'+b+'" does not exist in fixedHeaderTable plugin!'),void 0):e.init.apply(this,arguments)}}(jQuery);